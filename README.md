# Xellarium

## Идея проекта

Xellarium - это веб-приложение, которое предоставляет пользователям возможность создавать, редактировать и обмениваться правилами для клеточных автоматов (КА).
Пользователи могут создавать собственные коллекции правил, просматривать их выполнение в реальном времени и делиться ими с другими участниками сообщества путём создания подборок (коллекций).
Платформа также предоставляет обширную библиотеку стандартных правил клеточных автоматов для использования и изучения.

## Предметная область

Предметная область проекта Xellarium включает в себя изучение и разработку клеточных автоматов.
Клеточные автоматы - это дискретные модели, состоящие из сети ячеек, которые изменяют свое состояние в зависимости от состояния окружающих их ячеек.
Они используются для моделирования различных физических и биологических процессов, а также предоставляют возможность взаимодействия и наглядного отображения своей работы.

## Анализ аналогичных решений
В таблице приведен краткий анализ аналогичных решений.
Под частичной возможностью настройки правил подразумевается возможность выбора номера правила в одномерном случае и числа соседей для выживания и размножения в двумерном случае.
Полная возможность настройки правил также включает в себя настройку определения соседей клетки.
| Критерий                     | [playgameoflife](https://playgameoflife.com/) | [Discover Automata](https://discover-automata.vercel.app/#2.7.30) | [Cellular Automata Playground](https://albell.github.io/cellular-automata-playground/) | [Cellular Automata Online](https://adamullmann.github.io/Cellular-Automata-Online/) |
|------------------------------|----------------|-------------------|------------------------------|--------------------------|
| Поддержка двумерных КА       | Да             | Нет               | Нет                          | Да                       |
| Возможность настройки правил | Нет            | Да, полная        | Да, частичная     | Да, частичная            |
| Возможность сохранения КА    | Нет            | Да                | Нет                          | Нет                      |

## Функциональные требования

1. **Регистрация и аутентификация пользователей**
    - Пользователь должен иметь возможность зарегистрироваться в системе.
    - Пользователь должен иметь возможность войти в систему, используя свои учетные данные.

2. **Управление правилами клеточных автоматов**
    - Пользователь должен иметь возможность создавать новые правила клеточных автоматов.
    - Пользователь должен иметь возможность просматривать правила других пользователей.

3. **Управление коллекциями правил**
    - Пользователь должен иметь возможность создавать коллекции правил.
    - Пользователь должен иметь возможность добавлять правила в коллекции.
    - Пользователь должен иметь возможность удалять правила из коллекций.

4. **Просмотр и выполнение правил клеточных автоматов**
    - Пользователь должен иметь возможность просматривать список доступных правил.
    - Пользователь должен иметь возможность запускать выполнение правила клеточного автомата.
    - Пользователь должен иметь возможность останавливать выполнение клеточного автомата для изучения текущего состояния.

5. **Модерация контента**
    - Администратор должен иметь возможность просматривать список пользовательских правил.
    - Администратор должен иметь возможность изменять или удалять контент, противоречащий правилам.
    - Администратор должен иметь возможность делать контент приватным.

## Роли

    * Гость - потенциальный пользователь приложения, который может только просматривать контент приложения
    * Пользователь - зарегистрированный участник приложения, который может создавать собственные коллекции правил и редактировать их
    * Администратор - пользователь с расширенными правами доступа, который может управлять пользователями и контентом в приложении

## Use-Case диаграмма

<img src="docs/images/use_case.png">

## ER-диаграмма

<img src="docs/images/er.png">

## Диаграмма БД

<img src="docs/images/db_diagram.png">

## Пользовательские сценарии

#### Гость - просмотр правила клеточного автомата
    1. Гость входит в приложение и переходит на страницу просмотра правил клеточных автоматов.
    2. Гость просматривает список доступных правил, возможно, фильтруя их по категориям или тегам.
    3. Гость выбирает интересующее его правило и просматривает его описание, текст
    4. Гость опционально задаёт начальное состояние КА и запускает его выполнение
    5. При необходимости, Гость останавливает выполнение клеточного автомата для изучения текущего состояния

#### Пользователь - создание правила клеточного автомата
    1. Пользователь входит в приложение и переходит на страницу создания нового правила клеточного автомата.
    2. Пользователь выбирает категорию правила (1D или 2D)
    3. Пользователь вводит параметры правила
    4. Пользователь задаёт начальное состояние по-умолчанию
    5. Пользователь вводит название и описание правила
    6. После завершения ввода, пользователь сохраняет правило, которое становится доступным для других пользователей

#### Администратор - модерация пользовательского правила
    1. Администратор входит в приложение и просматривает список пользовательских правил
    2. Администратор обнаруживает текст, протеворечащий правилам, предъявляемым к пользовательскому контенту
    3. Администратор изменяет текст, либо удаляет/делает приватной единицу контента, например коллекцию или правило
    4. Изменение применяется и другие пользователи больше не могут встретить контент, протеворечащий требованиям требованиям

## Формализация бизнес-процессов

Используется версия нотации BPMN 2.0

#### Модерация единицы пользовательского контента

<img src="docs/images/Модель%20модерации.png">

## Верхнеуровневое разбиение на компоненты

<img src="docs/images/uml/components.png">

## Эскизы экранов будущего web-приложения

Главный экран для гостя
<img src="docs/images/ui_draft/main_guest.png">

Главный экран для вошедшего пользователя
<img src="docs/images/ui_draft/main_user.png">

Страница регистрации
<img src="docs/images/ui_draft/register.png">

Страница входа в аккаунт
<img src="docs/images/ui_draft/login.png">

Страница профиля
<img src="docs/images/ui_draft/profile.png">

Страница публичных коллекций
<img src="docs/images/ui_draft/public_collections.png">

Страница коллекции
<img src="docs/images/ui_draft/collection.png">

Страница правила
<img src="docs/images/ui_draft/rule.png">

Страница создания коллекции
<img src="docs/images/ui_draft/create_collection.png">

Страница создания правила
<img src="docs/images/ui_draft/create_rule.png">

## Описание типа приложения и используемого технологического стека

Тип приложения: Web SPA

Язык программирования: C#

Технологический стек:
- ASP.NET + Blazor WASM: платформа для разработки интерфейса и бизнес логики
- Entity Framework: ORM для доступа к данным;
- xUnit: библиотека тестирования
- Rider: интегрированная средка разработки

## UML диаграммы классов

##### Бизнес логика:
<img src="docs/images/uml/business_logic.png">
<img src="docs/images/uml/business_logic_services.png">

##### Доступ к данным:
<img src="docs/images/uml/data_access.png">

##### Web Api:
<img src="docs/images/uml/web_api.png">

##### Сервер:
<img src="docs/images/uml/server.png">

##### Технический UI:
<img src="docs/images/uml/tech_ui.png">

## Запуск проекта

### Настройка конфигурации

В разделе Databases в файле appsettings.json можно указать строку подключения к Postgres базе данных, либо название InMemory базы данных (InMemory база данных используется для тестирования работоспособности сервера и не сохраняет данные между запусками сервера).
После этого необходимо указать UsedDatabase, соответствующее используемой базе данных из предыдущего раздела.

### Миграция базы данных

Для миграции базы данных необходимо выполнить следующие команды:
```bash
dotnet ef --startup-project=./src/Xellarium.Server database update
```

### Запуск сервера

Для запуска сервера необходимо выполнить следующую команду:
```bash
dotnet run --project=./src/Xellarium.Server -lp "http"
```

### Технический UI

Для запуска технического UI необходимо перейти в директорию ./src/Xellarium.TechUi и запустить проект:
```bash
cd ./src/Xellarium.TechUi
dotnet run
```

## Сборка сервера

Для сборки сервера необходимо выполнить следующую команду:
```bash
dotnet publish .\src\Xellarium.Server\ -o artifacts/server
```

Запуск сервера:
```bash
cd artifacts/server
./Xellarium.Server.exe
```

Для сборки и запуска можно выполнить скрипт ./run_server.(sh|bat)

## Сборка технического UI

Для сборки технического UI необходимо выполнить следующую команду:
```bash
dotnet publish .\src\Xellarium.TechUi\ -o artifacts/techui
```

Запуск технического UI:
```bash
cd artifacts/techui
./Xellarium.TechUi.exe
```

Для сборки и запуска можно выполнить скрипт ./run_techui.(sh|bat)

## Сборка графического UI

Для сборки графического UI необходимо выполнить следующую команду:
```bash
dotnet publish .\src\Xellarium.Client\ -o artifacts/client
```

Запуск графического UI:
```bash
cd artifacts/client
dotnet serve --directory .\wwwroot\ -S
```

Для сборки и запуска можно выполнить скрипт ./run_client.(sh|bat)